import{r,p as c,j as e,b as j,a as S,L as k,e as w,f as F}from"./index-06c6c1f5.js";import{b as D,c as U}from"./isItemRegValid-c5d51572.js";import{a as R}from"./alertMessage-026c37b5.js";import{S as L,a as b,b as V}from"./SignForm-db7ab70d.js";import{g as I}from"./getPbImageURL-ebcdbcbf.js";import{H as O}from"./Header-49b89639.js";import{M as C}from"./MetaData-baa07fc2.js";import{G as E}from"./index.esm-c4f99d41.js";import"./index.esm-bcf7d115.js";import"./iconBase-51491e03.js";import"./PopUpModal-a427d51e.js";import"./index.esm-a526b47c.js";function v({labelValue:a,inputValue:m}){const[u]=r.useState(),[p,d]=r.useState(c.authStore.model.avatar?I(c.authStore.model,c.authStore.model.avatar):"/button-check.svg"),[f,o]=r.useState(!1),x=({target:g})=>{const l=g.files[0],h=URL.createObjectURL(l);d(h),m(l)},n=r.useRef(),i=()=>{n.current.click()};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mb-4 mt-6 flex flex-col items-center",children:[e.jsx("img",{className:`h-32 w-32 cursor-pointer rounded-full border-4 shadow-[0_1px_6px_rgba(0,0,0,0.1)] hover:border-primary ${!f||"border-primary"}`,src:p,alt:"프로필 사진",onClick:i}),e.jsx("label",{className:"sr-only",htmlFor:a,children:a}),e.jsx("input",{ref:n,type:"file",accept:"*.jpg,*.png,*.jpeg,*.webp,*.avif",onChange:x,onFocus:()=>o(!0),onBlur:()=>o(!1),value:u,id:a,className:"sr-only w-full cursor-pointer rounded px-7 py-4 text-base"})]})})}v.propTypes={labelValue:j.string,inputValue:j.func};function W(){const a=c.authStore.model,m=S(),[u,p]=r.useState(a.avatar),[d,f]=r.useState(a.nickname),[o,x]=r.useState(a.email),n={avatar:u,nickname:d,email:o};let i=new FormData;async function g(t,s){return(await F("users",t)).items.map(N=>N[t]).includes(s)}function l(){for(const[t,s]of Object.entries(n))i.append(t,s)}async function h(){for(const[t,s]of Object.entries(n))if(s!==a[t]){if(await g(t,s)){R("이미 사용중인 닉네임입니다.");return}if(!D(t,s)){U(t);return}}l(),await w("users",a.id,i),m("/")}const y={title:"Best Place - 업데이트",description:"유저 정보 업데이트",keywords:["유저","정보","업데이트"],image:"/logo.svg"};return e.jsxs("div",{className:"caret-transparent",children:[e.jsx(C,{props:y}),e.jsx(O,{}),e.jsxs("main",{className:"relative mx-auto max-w-3xl p-3",children:[e.jsx(k,{to:"/",className:"group absolute right-3.5 mr-1 inline",title:"설정 닫기",children:e.jsx(E,{className:"text-3xl hover:text-primary group-focus:text-primary"})}),e.jsxs("div",{className:"mx-auto max-w-sm",children:[e.jsx("h2",{className:"mt-3 text-center text-2xl font-bold",children:"프로필 수정"}),e.jsxs(L,{children:[e.jsx(v,{labelValue:"프로필 사진 변경",ariaLabel:"프로필 사진을 변경하세요.",inputValue:p}),e.jsx(b,{labelValue:"닉네임",placeHolder:a.nickname,inputValue:f}),e.jsx(b,{labelValue:"이메일",placeHolder:a.email,inputValue:x}),e.jsx("input",{type:"text",className:"hidden"})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-end gap-2",children:[e.jsx("p",{className:"text-lg font-bold",children:"프로필 변경"}),e.jsx(V,{ariaLabel:"프로필 수정",handleEvent:()=>h()})]})]})]})]})}export{W as default};
