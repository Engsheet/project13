import{b as r,j as e,p as c,r as g,L as f}from"./index-06c6c1f5.js";import{g as v}from"./getDate-b10b504c.js";import{g as n}from"./getPbImageURL-ebcdbcbf.js";import{F as N}from"./FeedItemHeader-aa1df1b8.js";import{u as U}from"./useQuery-7f8ad36b.js";import{e as I,f as S,g as k}from"./index.esm-1ff9b723.js";import{d as u}from"./debounce-1252dfff.js";import{S as F,N as D,P as B,K as T,a as $}from"./swiper-a857a5c8.js";function y({item:s}){return e.jsx(e.Fragment,{children:s.photos.length===1?s.photos.map(t=>e.jsx("img",{src:n(s,t),alt:"리뷰 사진",className:"aspect-video w-full rounded-lg object-cover hover:opacity-70"},crypto.randomUUID())):s.photos.length===2?e.jsx("div",{className:"flex aspect-video gap-0.5 [&>*:nth-child(1)]:rounded-l-lg [&>*:nth-child(2)]:rounded-r-lg",children:s.photos.map(t=>e.jsx("img",{src:n(s,t),alt:"리뷰 사진",className:"w-1/2 object-cover hover:opacity-70"},crypto.randomUUID()))}):s.photos.length===3?e.jsx("div",{className:`grid aspect-video grid-cols-[60%_40%] grid-rows-2 gap-0.5\r
        [&>*:nth-child(1)]:row-start-1 [&>*:nth-child(1)]:row-end-3 [&>*:nth-child(1)]:rounded-l-lg\r
        [&>*:nth-child(2)]:col-start-2 [&>*:nth-child(2)]:row-end-2 [&>*:nth-child(2)]:rounded-tr-lg\r
        [&>*:nth-child(3)]:col-start-2 [&>*:nth-child(3)]:row-end-3 [&>*:nth-child(3)]:rounded-br-lg`,children:s.photos.map(t=>e.jsx("img",{src:n(s,t),alt:"리뷰 사진",className:"h-full w-full object-cover hover:opacity-70"},crypto.randomUUID()))}):e.jsxs("div",{className:`relative grid aspect-video grid-cols-[60%_40%] grid-rows-2 gap-0.5\r
        [&>*:nth-child(1)]:row-start-1 [&>*:nth-child(1)]:row-end-3 [&>*:nth-child(1)]:rounded-l-lg\r
        [&>*:nth-child(2)]:col-start-2 [&>*:nth-child(2)]:row-end-2 [&>*:nth-child(2)]:rounded-tr-lg\r
        [&>*:nth-child(3)]:col-start-2 [&>*:nth-child(3)]:row-end-3 [&>*:nth-child(3)]:rounded-br-lg`,children:[s.photos.slice(0,3).map(t=>e.jsx("img",{src:n(s,t),alt:"리뷰 사진",className:"h-full w-full object-cover hover:opacity-70"},crypto.randomUUID())),e.jsxs("div",{className:"absolute -right-0.5 bottom-0 flex h-1/2 w-[40%] items-center justify-center rounded-br-lg bg-black bg-opacity-40 text-lg font-bold text-white hover:bg-opacity-60 sm:text-xl",children:["+",s.photos.slice(3).length]})]})})}y.propTypes={item:r.shape({photos:r.array})};function j({item:s}){return e.jsx("li",{className:"w-15 rounded-md bg-gray-100 px-2 py-1 text-sm text-gray-500",children:s})}j.propTypes={item:r.string};const L=()=>{const s=async()=>{try{return await c.collection("users").authRefresh()}catch(a){console.error(a)}},{data:t,error:o,refetch:l}=U({queryKey:["auth"],queryFn:s});return o&&console.error(o),{data:t,refetch:l}};function w({item:s,isPlace:t=!1}){const o=c.authStore.model.id,l=c.authStore.model,a=c.authStore.model.favorites,[x,d]=g.useState(!1),{data:i,refetch:b}=L();g.useEffect(()=>{i!=null&&i.record.favorites.includes(s.expand.place.id)?d(!0):d(!1)},[i,s.expand.place.id]);const m=async()=>{let p;x?(p=a.filter(h=>h!==s.expand.place.id),d(!1)):(p=[...a,s.expand.place.id],d(!0));try{await c.collection("users").update(o,{favorites:p})}catch(h){console.error(h)}b()};return e.jsx("div",{className:`${t?"py-4":"rounded-lg border py-2 pl-4 pr-2"} mb-2`,children:e.jsxs("div",{className:`flex items-center justify-between ${t?"mx-auto max-w-3xl px-3":""}`,children:[e.jsxs("dl",{className:"grid gap-1",children:[e.jsx("dt",{className:"sr-only",children:"플레이스 이름"}),e.jsx("dd",{className:"col-start-1 col-end-3 overflow-hidden text-ellipsis whitespace-nowrap pr-2 font-bold",children:s.expand.place.title}),e.jsx("dt",{className:"sr-only",children:"플레이스 카테고리"}),e.jsxs("dd",{className:"col-start-1 w-fit text-sm text-gray-500",children:[s.expand.place.category," ",e.jsx("span",{"aria-hidden":!0,children:"·"})]}),e.jsx("dt",{className:"sr-only",children:"플레이스 주소"}),e.jsx("dd",{className:"col-start-2 overflow-hidden text-ellipsis whitespace-nowrap pr-2 text-sm text-gray-500",children:s.expand.place.address})]}),e.jsxs("div",{className:"flex w-24 justify-end gap-2",children:[e.jsxs(f,{to:"/reservation-write",state:{userInfo:l,item:s},className:"flex flex-col items-center gap-2 p-2 hover:font-bold hover:text-secondary focus:font-bold focus:text-secondary",children:[e.jsx(I,{className:"text-xl"}),e.jsx("span",{className:"whitespace-nowrap text-xs",children:"예약"})]}),e.jsx("div",{className:"border-r"}),x?e.jsxs("button",{"aria-label":"플레이스 저장하기",className:"flex flex-col items-center gap-1 whitespace-nowrap p-2 text-primary hover:text-opacity-80",children:[e.jsx(S,{className:"text-2xl",onClick:u(()=>m(),500)}),e.jsx("span",{className:"text-xs",children:"저장됨"})]}):e.jsxs("button",{"aria-label":"플레이스 저장하기",className:"flex flex-col items-center gap-1 whitespace-nowrap p-2 text-gray-400 hover:font-bold hover:text-primary focus:font-bold focus:text-primary",children:[e.jsx(k,{className:"text-2xl",onClick:u(()=>m(),500)}),e.jsx("span",{className:"text-xs",children:"저장"})]})]})]})})}w.propTypes={item:r.shape({expand:r.shape({place:r.shape({title:r.string,category:r.string,address:r.string})})}),isPlace:r.bool};function C({item:s,isPlace:t,hiddenHeader:o,hiddenFooter:l}){return e.jsxs("div",{className:"flex flex-col gap-3 bg-white py-8",children:[o||e.jsx(N,{item:s}),t?e.jsxs("figure",{className:`${t&&"pt-3"}`,children:[e.jsx(F,{className:"photo-swiper",spaceBetween:30,navigation:!0,loop:!0,pagination:{type:"fraction"},keyboard:{enabled:!0},modules:[D,B,T],children:s.photos.map(a=>e.jsx($,{className:"bg-cover bg-center",children:e.jsx("img",{src:n(s,a),alt:"리뷰 사진",className:"h-full w-full rounded-lg object-cover"})},crypto.randomUUID()))}),e.jsx("figcaption",{className:`${t&&"pt-3"}`,children:e.jsx("p",{className:"mt-3 text-gray-700",children:s.contents})})]}):e.jsx(f,{to:`/place/${s.expand.place.id}/${s.id}`,children:e.jsxs("figure",{children:[e.jsx(y,{item:s}),e.jsx("figcaption",{children:e.jsx("p",{className:"mt-3 text-gray-700",children:s.contents})})]})}),e.jsx("ul",{className:"flex flex-wrap gap-2",children:s.keywords.map(a=>e.jsx(j,{item:a},crypto.randomUUID()))}),e.jsx("time",{dateTime:s.created,className:"pr-1 text-right text-sm text-gray-500",children:v(s.expand.reservation.date,"mm.dd day 방문")}),l||e.jsx(w,{item:s})]})}C.propTypes={item:r.shape({contents:r.string,photos:r.array,keywords:r.array,created:r.string}),isPlace:r.bool,hiddenHeader:r.bool,hiddenFooter:r.bool};export{C as F,w as a};
