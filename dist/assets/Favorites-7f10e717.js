import{r as u,j as e,b as y,p as g,S as v}from"./index-06c6c1f5.js";import{N}from"./NoResult-cde6063e.js";import{P as b}from"./PopUpModal-a427d51e.js";import{S as T}from"./ScrollTop-7e4dffaf.js";import{g as I}from"./getPbImageURL-ebcdbcbf.js";import{d as S}from"./index.esm-1ff9b723.js";import{M as C}from"./MetaData-baa07fc2.js";import{u as M}from"./useFetchRecord-61c5f7d8.js";import"./iconBase-51491e03.js";import"./useQuery-7f8ad36b.js";import"./useBaseQuery-d5fe4309.js";import"./index-ea9f9059.js";function j({items:n}){return u.useEffect(()=>{const c=document.getElementById("map"),p={center:new window.kakao.maps.LatLng(33.450701,126.570667),level:3},o=new window.kakao.maps.Map(c,p),m=new window.kakao.maps.MapTypeControl;o.addControl(m,window.kakao.maps.ControlPosition.TOPRIGHT);const x=new window.kakao.maps.ZoomControl;o.addControl(x,window.kakao.maps.ControlPosition.RIGHT);const s=new window.kakao.maps.LatLngBounds,w=new window.kakao.maps.services.Geocoder;n==null||n.forEach(d=>{w.addressSearch(d.address,function(a,h){if(h===window.kakao.maps.services.Status.OK){const l=new window.kakao.maps.LatLng(a[0].y,a[0].x),i=new window.kakao.maps.Marker({map:o,position:l});i.setMap(o),s.extend(l),o.setBounds(s),new window.kakao.maps.InfoWindow({content:`<div style="font-size:12px;width:150px;line-height:24px;text-align:center;padding:4px;">${d.title}</div>`}).open(o,i)}})})},[n]),e.jsx("div",{id:"map"})}j.propTypes={items:y.array};function K(){var i,f;const n=g.authStore.model.id,c=g.authStore.model.favorites,[p,o]=u.useState(!1),[m,x]=u.useState(""),{data:s,refetch:w,isLoading:d}=M("users",n,{expand:"favorites"});if(d)return e.jsx(v,{});const a=((f=(i=s==null?void 0:s.expand)==null?void 0:i.favorites)==null?void 0:f.length)&&(s==null?void 0:s.expand.favorites),h=async()=>{const t=c.filter(r=>r!==m);try{await g.collection("users").update(n,{favorites:t})}catch(r){console.error(r)}o(!1),w()},l={title:"Best Place - 저장",description:"즐겨찾기에 저장한 맛집들",keywords:["지도","맛집","즐겨찾기"],image:"/logo.svg"};return e.jsxs(e.Fragment,{children:[e.jsx(C,{props:l}),e.jsx(T,{}),e.jsx(b,{openModal:p,setOpenModal:o,modalTitle:"이 장소를 리스트에서 삭제합니다.",actionTitle:"삭제",handleEvent:h}),a?e.jsxs("main",{children:[e.jsx("h2",{className:"sr-only",children:"저장 페이지"}),e.jsxs("h3",{className:"py-4 text-center text-xl font-extrabold",children:[e.jsx("span",{className:"mr-2",children:"🍴"}),"내가 저장한 맛집"]}),e.jsx("div",{id:"map",className:"my-2 h-96 w-full rounded-lg bg-gray-300",children:e.jsx(j,{items:a})}),e.jsx("ul",{className:"mb-10 mt-6",children:a==null?void 0:a.map(t=>e.jsxs("li",{className:"border-b border-gray-100 py-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("dl",{className:"grid grid-cols-[fit-content(100ch)_1fr] items-center gap-x-2",children:[e.jsx("dt",{className:"sr-only",children:"플레이스 이름"}),e.jsx("dd",{className:"col-start-1 row-start-1 overflow-hidden text-ellipsis whitespace-nowrap text-lg font-bold",children:t.title}),e.jsx("dt",{className:"sr-only",children:"플레이스 카테고리"}),e.jsx("dd",{className:"col-start-2 row-start-1 text-sm font-light text-gray-500",children:t.category}),e.jsx("dt",{className:"sr-only",children:"플레이스 주소"}),e.jsx("dd",{className:"col-start-1 col-end-3 overflow-hidden text-ellipsis whitespace-nowrap font-light",children:t.address})]}),e.jsx("button",{type:"button",onClick:()=>{x(t.id),o(!0)},"aria-label":"장소 삭제하기",className:"group h-8 w-8",children:e.jsx(S,{className:"m-auto text-center text-xl text-primary hover:text-secondary group-focus:text-secondary","aria-hidden":!0})})]}),e.jsx("figure",{className:"flex h-28 gap-1 pt-3",children:t.photos.slice(0,3).map((r,k)=>e.jsx("img",{src:I(t,r),alt:`${t.title}의 ${k+1}번째 사진`,className:"w-1/3 rounded-lg object-cover"},r))})]},crypto.randomUUID()))})]}):e.jsx(N,{title:"회원님이 저장한 장소가 없어요.",contents:"자주 방문하는 장소를 저장해보세요!"})]})}export{K as default};
